# Full Stack Application Configuration
quarkus.application.name=flowcatalyst
quarkus.banner.enabled=false

# =============================================================================
# SPA Fallback (serve index.html for client-side routes)
# =============================================================================
quarkus.http.enable-compression=true

# =============================================================================
# Authentication Configuration
# =============================================================================

# External base URL for OAuth callbacks (e.g., http://localhost:4200 in dev)
flowcatalyst.auth.external-base-url=${FLOWCATALYST_EXTERNAL_BASE_URL:}
%dev.flowcatalyst.auth.external-base-url=http://localhost:4200

# JWT Configuration
flowcatalyst.auth.jwt.issuer=${FLOWCATALYST_JWT_ISSUER:flowcatalyst}
flowcatalyst.auth.jwt.private-key=${FLOWCATALYST_JWT_PRIVATE_KEY:}
flowcatalyst.auth.jwt.public-key=${FLOWCATALYST_JWT_PUBLIC_KEY:}
flowcatalyst.auth.jwt.previous-public-key=${FLOWCATALYST_JWT_PREVIOUS_PUBLIC_KEY:}
flowcatalyst.auth.jwt.private-key-path=${FLOWCATALYST_JWT_PRIVATE_KEY_PATH:}
flowcatalyst.auth.jwt.public-key-path=${FLOWCATALYST_JWT_PUBLIC_KEY_PATH:}
flowcatalyst.auth.jwt.access-token-expiry=${FLOWCATALYST_ACCESS_TOKEN_EXPIRY:PT1H}
flowcatalyst.auth.jwt.session-token-expiry=${FLOWCATALYST_SESSION_TOKEN_EXPIRY:PT8H}
flowcatalyst.auth.jwt.refresh-token-expiry=${FLOWCATALYST_REFRESH_TOKEN_EXPIRY:P30D}
flowcatalyst.auth.jwt.authorization-code-expiry=${FLOWCATALYST_AUTH_CODE_EXPIRY:PT10M}

# Session/Cookie Configuration
flowcatalyst.auth.session.secure=${FLOWCATALYST_SESSION_SECURE:true}
flowcatalyst.auth.session.same-site=${FLOWCATALYST_SESSION_SAME_SITE:Lax}
flowcatalyst.auth.session.cookie-name=${FLOWCATALYST_SESSION_COOKIE:fc_session}
%dev.flowcatalyst.auth.session.secure=false

# PKCE Configuration
flowcatalyst.auth.pkce.required=${FLOWCATALYST_PKCE_REQUIRED:true}

# MP JWT (delegates to our issuer)
mp.jwt.verify.issuer=${flowcatalyst.auth.jwt.issuer}

# Disable Quarkus OIDC client (platform has its own embedded OIDC server)
quarkus.oidc.enabled=false

# Redis (pulled in by standby module, only needed when standby.enabled=true)
# Override with real Redis URL when enabling standby mode
quarkus.redis.hosts=${REDIS_URL:redis://localhost:6379}

# Logging Configuration - Dev: readable logs (not JSON)
%dev.quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n
%dev.quarkus.log.console.json.enabled=false
%dev.quarkus.log.level=INFO
%dev.quarkus.log.category."tech.flowcatalyst".level=DEBUG

# Logging Configuration - Prod: JSON structured logs
%prod.quarkus.log.console.format=json
%prod.quarkus.log.console.json.pretty-print=false
%prod.quarkus.log.level=INFO
%prod.quarkus.log.console.json.additional-field."service.name".value=flowcatalyst
%prod.quarkus.log.console.json.additional-field."service.version".value=${quarkus.application.version:1.0.0-SNAPSHOT}
%prod.quarkus.log.console.json.additional-field."environment".value=${ENVIRONMENT:production}

# HTTP Auth - Platform handles authentication via its own filters
# Quarkus HTTP auth is not used (platform has custom OAuth/session handling)

# =============================================================================
# Platform Feature Flags
# =============================================================================

# Enable/disable messaging features (Event Types, Subscriptions, Dispatch Pools/Jobs)
flowcatalyst.features.messaging-enabled=${FLOWCATALYST_FEATURES_MESSAGING_ENABLED:true}

# =============================================================================
# Bootstrap Configuration (First Run)
# =============================================================================
# On first startup, if no anchor users exist, create an admin from these env vars.
# The email domain will automatically be registered as an anchor domain.

flowcatalyst.bootstrap.admin.email=${FLOWCATALYST_BOOTSTRAP_ADMIN_EMAIL:}
flowcatalyst.bootstrap.admin.password=${FLOWCATALYST_BOOTSTRAP_ADMIN_PASSWORD:}
flowcatalyst.bootstrap.admin.name=${FLOWCATALYST_BOOTSTRAP_ADMIN_NAME:Bootstrap Admin}



# =============================================================================
# PostgreSQL Configuration (Primary Database)
# =============================================================================

# Production PostgreSQL settings (override via environment variables)
quarkus.datasource.db-kind=postgresql
quarkus.datasource.jdbc.url=${POSTGRES_URL:jdbc:postgresql://localhost:5432/flowcatalyst}
quarkus.datasource.username=${POSTGRES_USER:flowcatalyst}
quarkus.datasource.password=${POSTGRES_PASSWORD:flowcatalyst}
quarkus.datasource.jdbc.max-size=20

# Dev profile
%dev.quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/flowcatalyst
%dev.quarkus.datasource.username=flowcatalyst
%dev.quarkus.datasource.password=flowcatalyst
