# FlowCatalyst Configuration
# Copy this to .env and modify as needed.

# =============================================================================
# Service Toggles
# =============================================================================
# Enable/disable individual services in this process.
PLATFORM_ENABLED=true
MESSAGE_ROUTER_ENABLED=false
STREAM_PROCESSOR_ENABLED=true

# Run database migrations on startup (default: true in development, false in production)
AUTO_MIGRATE=true

# =============================================================================
# Frontend
# =============================================================================
# Optional: path to built frontend assets (auto-detected if omitted)
# FRONTEND_DIR=./dist/frontend

# =============================================================================
# Server
# =============================================================================
PLATFORM_PORT=3000
ROUTER_PORT=8080
HOST=0.0.0.0
NODE_ENV=development
LOG_LEVEL=debug

# =============================================================================
# Database
# =============================================================================
DATABASE_URL=postgres://postgres:postgres@localhost:5432/flowcatalyst

# =============================================================================
# OIDC / Auth (Platform)
# =============================================================================
# JWT_SECRET=                          # Symmetric secret (dev only, prefer RS256 keys)
# JWT_ISSUER=flowcatalyst
# JWT_AUDIENCE=flowcatalyst
# EXTERNAL_BASE_URL=https://your-domain.com
# OIDC_ISSUER=https://your-domain.com
# OIDC_COOKIES_KEYS=secret-key-1,secret-key-2

# RS256 JWT keys
# JWT_KEY_DIR=.jwt-keys               # Key directory (rotation-capable, use with `flowcatalyst rotate-keys`)
# JWT_PRIVATE_KEY_PATH=/path/to/private.pem  # Legacy: single key file (production)
# JWT_PUBLIC_KEY_PATH=/path/to/public.pem    # Legacy: single key file (production)
# JWT_DEV_KEY_DIR=.jwt-keys           # Dev only: auto-generated keys dir

# OIDC token expiry (seconds)
# OIDC_ACCESS_TOKEN_TTL=3600          # 1 hour
# OIDC_ID_TOKEN_TTL=3600              # 1 hour
# OIDC_REFRESH_TOKEN_TTL=2592000      # 30 days
# OIDC_SESSION_TTL=86400              # 24 hours
# OIDC_AUTH_CODE_TTL=600              # 10 minutes

# =============================================================================
# Encryption Key (Platform)
# =============================================================================
# 32-byte hex key for AES-256-GCM encryption of secrets
# Generate with: openssl rand -hex 32
FLOWCATALYST_APP_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# =============================================================================
# Bootstrap Admin (first-run setup)
# =============================================================================
# Set these to create an initial admin user on first startup.
# Only runs if no ANCHOR-scoped users exist in the database.
FLOWCATALYST_BOOTSTRAP_ADMIN_EMAIL=admin@example.com
FLOWCATALYST_BOOTSTRAP_ADMIN_PASSWORD=ChangeMe123!
# FLOWCATALYST_BOOTSTRAP_ADMIN_NAME=Bootstrap Admin

# =============================================================================
# Stream Processor
# =============================================================================
# STREAM_PROCESSOR_EVENTS_ENABLED=true
# STREAM_PROCESSOR_EVENTS_BATCH_SIZE=100
# STREAM_PROCESSOR_DISPATCH_JOBS_ENABLED=true
# STREAM_PROCESSOR_DISPATCH_JOBS_BATCH_SIZE=100

# =============================================================================
# Message Router
# =============================================================================
# Queue type: EMBEDDED uses in-memory SQLite (no external dependencies)
QUEUE_TYPE=EMBEDDED
# EMBEDDED_DB_PATH=:memory:

# =============================================================================
# Message Router Authentication
# =============================================================================
# Disabled by default for local development
AUTHENTICATION_ENABLED=false
AUTHENTICATION_MODE=NONE
